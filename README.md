
# Project Title  
This is a system that uses Xilinx Dynamic Function Exchange for ultra96v2 borad.  

## Run Locally  

#### Clone the project  

~~~bash  
  git clone https://github.com/luiscarlos63/ultra96v2_crypt.git
~~~

#### Open the project 

~~~bash  
  Vivado->Run TCL script->/ultra96v2_dfx.tcl
~~~
This opens sets the Vivado project. The center of system is the
Block Design. The project is ready to generate bitstreams.


### Systesis
Systesis runs all the Out-Of-Context modules, including the 
IPs that are used inside the Reconfigurable Partitions.


### Implementation
Implementation occurs in **configurations** this project only
uses 3 configuration.
You can see the way the IPs are distributed among the **configurations**, for that, in Vivado, open:
~~~
Flow Navigator-> Project Manager->Dynamic Functio eXchange Wizard
~~~
Here you find:

- Which Reconfigurable Modules (they represent the IPs) that are
associated with which partitions
- The configurations for the Implementation. This configurations 
basically represent the 3 full bitstreams that are generated by Vivado.
- Lastlly it shows the Implementation runs that correspont to each configuration.

### Generate bitstreams
To generate the proper bitstreams expected by system go to:

~~~
Design Runs->Select the 3 Implementation runs-> Right click -> Generate bitstreams -> Select -bin_file 
~~~

After the bitstreams are generated you need to opy them to a folder.
This bitstreams are in:
~~~
PROJECT_FOLDER/vivado_project/ultra96v2_dfx.runs/impl_1
                                                /child_0_impl_1
                                                /child_1_impl_1
~~~
Each of these directories has 3 files with **.bin** extention. These are the files you should copy.

### Prepare bitstreams
After they are placed in a folder copy the files inside 
*PROJECT_FOLDER/scripts*
to that folder. **Change the first line in *prepare_partial* for you full path to the folder you copyed the bitsreams** 

#### From the vivado console
~~~
source [get_property REPOSITORY [get_ipdefs *dfx_controller:1.0]]/xilinx/dfx_controller_v1_0/tcl/api.tcl –notrace​
source /full_path_to_folder/prepare_partial
~~~
this will generate a folder with the bitstreams in the format expected by **ICAP**
#### From the shell
~~~bash
./encrypt.sh
~~~
This will encrypt the bitsreams, now youjust need to copy them to the SD card.